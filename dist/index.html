<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <!-- 页面的元信息 -->
    <title>测试预览页面</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=1000, user-scalable=yes"/>
    <meta name="format-detection" content="telephone=no, email=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="white"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="filetype" content="1"/>
    <meta name="publishedtype" content="1"/>
    <meta name="pagetype" content="2"/>
    <meta name="description" content="{TAG_59447_TAG}"/>
    <meta name="keywords" content="{TAG_59446_TAG}"/>
    <meta name="catalogs" content="{TAG_83943_TAG}"/>
    
      <!-- 页面主样式文件 -->
      <link charset="utf-8"  rel="stylesheet" href="./static/css/owo.core.css">
      
    <!-- 附属css文件 -->
    <link rel="stylesheet" href="./static/css/main.css" charset="utf-8">
    <link rel="stylesheet" href="https://cunchu.site/work/login/standard.css" charset="utf-8">
      
  </head>
  <body>
    
    <!-- 页面[page]-->
    <div class="home clear page" template="page" style="display: block;"><div class="owo fl left-panel"><div class="select-box"></div><h2>选择图表类型</h2><select id="dataType"><option value="funnel">漏斗图</option><option value="radar">雷达图</option><option value="line">折线图</option><option value="bar">柱状图</option><option value="scatter">散点图</option></select><h2>选择颜色风格</h2><select id="dataType"><option value="[]">默认风格</option><option value="['#b0222e','#f0cb7a','#f9d895']">风格1</option></select><h2>导入数据</h2><div class="panel"><div class="down" o-tap="down">点击下载</div><input id="fileUp" type="file"></div><textarea class="data-textbox"></textarea><h2>图表宽度</h2><input class="chart-width" type="number" value="800"><h2>图表高度</h2><input class="chart-height" type="number" value="800"><div class="owo button" o-tap="createdChart">生成图表</div></div><div class="fr"><div class="chart-box"><div id="chart"></div></div><div class="bottom-bar clear"><div class="owo owo-lable"></div></div></div></div>
    
<!-- 框架script文件 -->
<script src="./static/js/owo.core.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript" charset="UTF-8">
owo.script = {
  "page": {
    "data": {
      "myChart": null
    },
    "created": function created() {
      var input = document.querySelector('#fileUp');
      input.addEventListener('input', function () {
        var inputFile = input.files[0];

        if (inputFile) {
          var reader = new FileReader();
          var resultFile = input.files[0]; //获得本地的图片地址  放在reader.result内
          // 读取纯文本文件,且编码格式为 utf-8

          reader.readAsText(resultFile, 'UTF-8'); // 读取文件,会触发 onload 异步事件,可使用回调函数 来获取最终的值.

          reader.onload = function (e) {
            var fileContent = e.target.result;
            document.querySelector('.data-textbox').value = fileContent;
          };
        }
      });
    },
    "createdChart": function createdChart() {
      var fileData = document.querySelector('.data-textbox').value;
      var typeTemp = document.querySelector('#dataType').value;

      switch (typeTemp) {
        case 'radar':
          this.init(radarHandle(fileData));
          break;

        case 'funnel':
          this.init(funnelHandle(fileData));
          break;

        case 'line':
          this.init(lineHandle(fileData));
          break;

        case 'bar':
          this.init(barHandle(fileData));
          break;

        case 'scatter':
          this.init(scatterHandle(fileData));
          break;

        default:
          break;
      }
    },
    "down": function down() {
      var typeTemp = document.querySelector('#dataType').value;

      switch (typeTemp) {
        case 'radar':
          window.open('https://cunchu.site/mock/chart_csv/%E9%9B%B7%E8%BE%BE%E5%9B%BE.csv');
          break;

        case 'funnel':
          window.open('https://cunchu.site/mock/chart_csv/%E6%BC%8F%E6%96%97%E5%9B%BE.csv');
          break;

        default:
          break;
      }
    },
    "init": function init(option) {
      if (this.data.myChart) {
        this.data.myChart.dispose();
        this.data.myChart = null;
      }

      var chartDom = document.getElementById('chart');
      chartDom.style.width = document.querySelector('.chart-width').value + 'px';
      chartDom.style.height = document.querySelector('.chart-height').value + 'px';
      this.data.myChart = echarts.init(chartDom);
      option && this.data.myChart.setOption(option);
    }
  }
};
</script>

    <script src="./static/js/main.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="./static/js/echarts.min.js.js" type="text/javascript"  charset="UTF-8"></script>
    <script src="https://cunchu.site/work/login/standard.js" type="text/javascript"  charset="UTF-8"></script>

  </body>
</html>